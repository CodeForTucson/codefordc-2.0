<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="">
		<title>Code for DC</title>
		<link rel="shortcut icon" href="images/favicon.ico" />
		<!-- Bootstrap core CSS -->
		<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<!-- Custom styles for this template -->
		<link href="style.css" rel="stylesheet">
	</head>

  <body>

<div id="navbar-wrapper">    
	<div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img src="images/c4dc-logo-white-30x58.png"/></a>
        <div class="nav-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Get Involved</a></li>
            <li class="active"><a href="projects.html">Projects</a></li>
            <li><a href="press.html">Press</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
</div>

    <div class="container">
      <div class="col-lg-1"></div>
      <div class="col-lg-10 ">
        <div class="col-lg-12 starter-template">
          <h1>Projects</h1>
          <p class="lead">Code for DC is a collaborative environment in which people with many different skillsets tackle issues they see facing the community. Our projects are always looking for help.  Browse below and you're bound to find a project that needs you!</p>
        </div>


		<div id="project-list">
			<div id="projects-active"></div>
			<div id="projects-new"></div>
		</div>

    <div class="col-lg-1"></div>



  </div><!-- /.container -->

    <script src="assets/js/jquery.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/js/jquery.csv-0.71.min.js"></script>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-44079248-1', 'codefordc.org');
	  ga('send', 'pageview');

	</script>
    <script type="text/javascript">

    	function getProjectList(data){
    		projectList = $.csv.toArrays(data);
			projectList.splice(0,1); //get rid of column headers
			return projectList;
    	}

    	function getProject(pRec,pNum){
			var p = Array;
			p["id"] = "project" + pNum;
			p["status"] = pRec[7];
			p["title"] = pRec[0];
			
			if(p["title"] == ""){
				p["title"] = "Unnamed project";
			}
			p["desc"] = pRec[1];

			p["contact"] = pRec[2];
			if(p["contact"] == ""){ 
				p["contact"] == "Matt Bailey";
			}
			p["twitter"] = pRec[3];
			if(p["twitter"] == "" && p["contact"]== "Matt Bailey"){
				p["twitter"] == "@mattbailey0";
			}
			
			p["email"] = pRec[4];
		
			p["needs"] = pRec[5];
			if(p["status"] == "not started"){
				p["needs"] = "This project hasn't started! Get in touch to kick it off."
			}
			
			p["url_info"]= pRec[8];
			p["github"] = pRec[9];
			p["url_home"] = pRec[10];
			
			return p;
		}


		function getGitContent(project, url){
		var projectElement = "#" + project + " .project-contribs";

		var chunked_url = url.split("/");
		git_user = chunked_url[3];
		git_repo = chunked_url[4];

		$.get('https://api.github.com/repos/' + git_user + '/' + git_repo + '/contributors').done(function(data){
			var val = '';
			$.each( data, function(index, value	){
				
				$(projectElement).after("<a href='" + value.html_url + "'><img src='" + value.avatar_url + "' class='project-git-human'  /></a> ");
			});
		});
	}


		$(document).ready(function(){

			$.get('/data/projects.csv', function(data){
				var projectList = getProjectList(data);
				var pContentRow = '';
						
				for(var row in projectList){
					if(projectList[row][7] != "inactive"){
						var p = getProject(projectList[row],row);
						
						var pRow = $("<div/>",{class:'col-lg-12 project-row'});

						var pLeftPad = $("<div/>",{class:'col-lg-1'});
						var pCenter = $("<div/>",{class:'col-lg-10',id:p['id']});
						var pRightPad = $("<div/>",{class:'col-lg-1'});
		
						$(pCenter).append($('<h3/>',{class:'project-title'}).text(p["title"]));						

						$(pCenter).append($('<div/>',{class:'project-contribs'}));
						
						if(p["desc"] != ""){
							pContentRow = $("<div/>",{class:'col-lg-12'});
							$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.text("Description:")
							);
							$(pContentRow).append(
								$('<div/>	',{class:"project-description project-content"})
									.text(p["desc"])
							);
							$(pCenter).append(pContentRow);
						}
						
						var contactString = p["contact"];
						if(p["twitter"] != ""){
							contactString += ' (<a href="http://www.twitter.com/' + p["twitter"].substring(1) +'">'+ p["twitter"] +'</a>)';
						}
						pContentRow = $("<div/>",{class:'col-lg-12'});	
						$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.text("Contact:")
							);
						$(pContentRow).append(
								$('<div/>',{class:"project-content"})
									.html(contactString)
							);
						$(pCenter).append(pContentRow);
						

						if(p["needs"] != ""){
							pContentRow = $("<div/>",{class:'col-lg-12'});
							$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.text("Needs:")
							);
							$(pContentRow).append(
								$('<div/>',{class:"project-content"})
									.text(p["needs"])
							);
							$(pCenter).append(pContentRow);
						}

						if(p["url_info"] != ""){
							pContentRow = $("<div/>",{class:'col-lg-12'});
							//$(pCenter).append('<p class="project-content"><a href="' + p["url_info"] +'" target="_blank">Read more about this project</a></p>');
							$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.html('')
							);
							$(pContentRow).append(
								$('<div/>',{class:"project-content"})
									.html('<a href="' + p["url_info"] +'" target="_blank"><img src="/images/captain.png" class="project-label-icon" />Read more about this project</a>')
							);
							$(pCenter).append(pContentRow);
						}
						

						if(p["github"] != ""){
							pContentRow = $("<div/>",{class:'col-lg-12'});
							$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.html('')
							);
							$(pContentRow).append(
								$('<div/>',{class:"project-content"})
									.html('<a href="'+ p["github"] +'" target="_blank"><img src="/images/octocat.png" class="project-label-icon" />Browse the code</a>')
							);
							$(pCenter).append(pContentRow);

							getGitContent(p["id"],p["github"]);
						}
						

						if(p["url_home"] != "" && p["url_home"].indexOf("www.codefordc.org") == -1 ){
							pContentRow = $("<div/>",{class:'col-lg-12'});
							$(pContentRow).append(
								$('<div/>',{class:"project-label"})
									.html('')
							);
							$(pContentRow).append(
								$('<div/>',{class:"project-content"})
									.html('<a href="'+ p["url_home"]+'" target="_blank"><img src="/images/launch.png" class="project-label-icon" />Check out the website</a>')
							);
							$(pCenter).append(pContentRow);

						}
						
						$(pCenter)
							.append(
								$("<div/>",
									{class:'col-lg-12'}
								).html('<hr />'));

						$(pRow).append(pLeftPad);
						$(pRow).append(pCenter);
						$(pRow).append(pRightPad);

						$('#projects-active').append(pRow);
						

					}
				}
						
			}
		);
      });



	
    </script>
  </body>
</html>
